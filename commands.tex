\usepackage{xparse}

\NewDocumentCommand{\link}{ s D(){i} D(){j} }{
    \IfBooleanTF{#1}
        {#2 \not\rightarrow #3}
        {#2     \rightarrow #3}
}

\NewDocumentCommand{\sub}{ d() D(){ij} }{ #1_{#2} }

\NewDocumentCommand{\xfig}{ D(){!htb} s O{width=0.7\textwidth} D//{figures} m O{} }{
    \begin{figure}[#1]
        \centering
        \IfBooleanTF {#2}
            { \input{#4/#5} }
            { \includegraphics[#3]{#4/#5} }
        \caption{#6} 
        \label{fig:#5}
    \end{figure}
}

\NewDocumentCommand{\xtab}{ D(){!htb} D//{tables} m O{} }{
    \begin{table}[#1]
        \centering
        \input{#2/#3}
        \caption{#4}
        \label{tab:#3}
    \end{table}
}

\NewDocumentCommand{\xanim}{ D(){H} O{width=\textwidth} D||{12} m O{} }{
    \begin{figure}[#1]
        \centering
        \animategraphics[#2]{#3}{figures/#4}{}{}
        \caption{#5 (view in Adobe Reader)}
        \label{fig:#4}
    \end{figure}
}

\NewDocumentCommand{\xfigfig}{ D(){!htb} O{} m O{} m O{} }{
    \begin{figure}[#1]
        \centering
        \begin{minipage}[t]{.48\textwidth}
            \centering
            \includegraphics[#2, width=\textwidth]{figures/#3}
            \captionof{figure}{#4}
            \label{fig:#3}
        \end{minipage}%
        \hfill%
        \begin{minipage}[t]{.48\textwidth}
            \centering
            \includegraphics[#2, width=\textwidth]{figures/#5}
            \captionof{figure}{#6}
            \label{fig:#5}
        \end{minipage}
    \end{figure}
}

\NewDocumentCommand{\xanimanim}{ D(){!htb} O{} D||{12} m O{} m O{} }{
    \begin{figure}[#1]
        \centering
        \begin{minipage}[t]{.48\textwidth}
            \centering
            \animategraphics[#2, width=\textwidth]{#3}{figures/#4}{}{}
            \captionof{figure}{#5 (view in Adobe Reader)}
            \label{fig:#3}
        \end{minipage}%
        \hfill%
        \begin{minipage}[t]{.48\textwidth}
            \centering
            \animategraphics[#2, width=\textwidth]{#3}{figures/#6}{}{}
            \captionof{figure}{#7 (view in Adobe Reader)}
            \label{fig:#6}
        \end{minipage}
    \end{figure}
}